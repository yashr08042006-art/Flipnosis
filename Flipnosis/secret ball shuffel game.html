<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üé© Secret Sphere Shuffle üé©</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: linear-gradient(135deg, #1e90ff, #00c6ff);
      font-family: "Segoe UI", Tahoma, sans-serif;
      padding: 30px;
      color: #fff;
      min-height: 100vh;
      overflow-x: hidden;
    }

    h1 {
      font-size: 42px;
      color: #ffd700;
      text-shadow: 0 0 10px #ff8c00, 0 0 20px #ff4500;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    h1 img {
      width: 50px;
      height: 50px;
    }

    #game {
      position: relative;
      width: 1200px;
      height: 300px;
      margin-bottom: 30px;
      border: 3px solid #ffd700;
      border-radius: 15px;
      background: linear-gradient(to bottom, #0099cc, #003366);
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
      overflow: hidden;
    }

    .cup {
      width: 90px;
      height: 130px;
      background: linear-gradient(to bottom, #ff7f50, #b22222);
      border-radius: 0 0 50px 50px;
      position: absolute;
      bottom: 40px;
      cursor: pointer;
      transition: transform 0.4s, left 0.4s;
      border: 2px solid #5a0000;
      box-shadow: inset 0 -6px 10px rgba(0,0,0,0.6), 0 8px 20px rgba(0,0,0,0.6);
      z-index: 2;
    }

    .cup::before {
      content: "";
      position: absolute;
      top: -12px;
      left: 8px;
      width: 70px;
      height: 18px;
      background: radial-gradient(circle at 50% 50%, #ffdab9, #8b0000);
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0,0,0,0.6);
    }

    .cup:hover {
      transform: scale(1.08);
      box-shadow: 0 10px 25px rgba(255, 215, 0, 0.8);
    }

    .cup.lifted {
      transform: translateY(-90px) scale(1.05);
    }

    .ball {
      width: 40px;
      height: 40px;
      background: radial-gradient(circle at 30% 30%, #ff3b3b, #800000);
      border-radius: 50%;
      position: absolute;
      bottom: 45px;
      left: 0;
      transition: left 0.5s;
      z-index: 1;
      visibility: hidden;
      box-shadow: 0 0 15px #ff0000, 0 0 30px #ff4500;
    }

    .ball::after {
      content: "";
      position: absolute;
      top: 6px;
      left: 8px;
      width: 15px;
      height: 15px;
      background: rgba(255,255,255,0.6);
      border-radius: 50%;
      filter: blur(2px);
    }

    #message {
      font-size: 24px;
      margin: 15px;
      min-height: 36px;
      font-weight: bold;
      color: #ffd700;
      text-shadow: 0 0 10px #ff4500;
      text-align: center;
    }

    #timer {
      font-size: 28px;
      font-weight: bold;
      color: #32cd32;
      text-shadow: 0 0 10px #00ff00;
      margin-bottom: 15px;
    }

    #startBtn {
      padding: 14px 34px;
      font-size: 22px;
      background: linear-gradient(135deg, #32cd32, #228b22);
      color: #fff;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 0 20px rgba(50,205,50,0.7);
      transition: all 0.25s ease;
    }

    #startBtn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 30px rgba(50,205,50,1);
    }

    #startBtn:active {
      transform: scale(0.95);
      background: linear-gradient(135deg, #2e8b57, #006400);
    }
  </style>
</head>
<body>
  <h1>
    <img src="https://cdn-icons-png.flaticon.com/512/2934/2934006.png" alt="logo">
    Secret Sphere Shuffle
    <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="magic">
  </h1>

  <div id="game"></div>
  <div class="ball" id="ball"></div>
  <div id="message">Click "Start" to play!</div>
  <div id="timer"></div>
  <button id="startBtn">Start</button>

  <script>
    const NUM_CUPS = 10;
    const cupWidth = 90;
    const cupSpacing = 25;
    const cupLefts = [...Array(NUM_CUPS).keys()].map(i => i*(cupWidth + cupSpacing) + 30);
    const gameDiv = document.getElementById('game');
    const message = document.getElementById('message');
    const timerDiv = document.getElementById('timer');
    const startBtn = document.getElementById('startBtn');
    const ball = document.getElementById('ball');
    let cups = [];
    let ballIndex = 0;
    let mixed = false;
    let liftTimeout = null;
    let countdown = null;

    function createCups(){
      gameDiv.innerHTML = "";
      cups = [];
      for(let i=0; i<NUM_CUPS; i++){
        const cup = document.createElement('div');
        cup.className = 'cup';
        cup.style.left = cupLefts[i] + 'px';
        cup.id = `cup${i}`;
        gameDiv.appendChild(cup);
        cups.push(cup);
      }
    }
    createCups();

    function positionBall(idx){
      ball.style.left = (cupLefts[idx] + cupWidth/2 - 20) + 'px';
    }

    function shuffleCups(times=25, callback){
      let swaps = 0;
      let positions = cupLefts.slice();
      let interval = setInterval(()=>{
        const idx1 = Math.floor(Math.random() * NUM_CUPS);
        let idx2 = Math.floor(Math.random() * NUM_CUPS);
        while(idx2 === idx1) idx2 = Math.floor(Math.random() * NUM_CUPS);

        [positions[idx1], positions[idx2]] = [positions[idx2], positions[idx1]];
        cups[idx1].style.left = positions[idx1] + 'px';
        cups[idx2].style.left = positions[idx2] + 'px';

        if(ballIndex === idx1) ballIndex = idx2;
        else if(ballIndex === idx2) ballIndex = idx1;

        swaps++;
        if(swaps >= times){
          clearInterval(interval);
          callback();
        }
      }, 250);
    }

    function resetGame(){
      createCups();
      ballIndex = Math.floor(Math.random() * NUM_CUPS);
      for(let i=0; i<NUM_CUPS; i++){
        cups[i].style.left = cupLefts[i] + 'px';
        cups[i].classList.remove('lifted');
      }
      positionBall(ballIndex);
      ball.style.visibility = "hidden";
      mixed = false;
      message.textContent = "Click \"Start\" to play!";
      timerDiv.textContent = "";
      if(countdown) clearInterval(countdown);
    }

    function startCountdown(){
      let timeLeft = 6;
      timerDiv.textContent = "‚è≥ " + timeLeft + "s left";
      countdown = setInterval(()=>{
        timeLeft--;
        timerDiv.textContent = "‚è≥ " + timeLeft + "s left";
        if(timeLeft <= 0){
          clearInterval(countdown);
          timerDiv.textContent = "‚è∞ Time's up!";
          if(mixed){
            message.textContent = "‚ùå You ran out of time!";
            mixed = false;
          }
        }
      }, 1000);
    }

    startBtn.onclick = function(){
      resetGame();
      // Show ball clearly for 1 second before shuffle
      ball.style.visibility = "visible";
      message.textContent = "üëÄ Watch the ball!";
      setTimeout(()=>{
        ball.style.visibility = "hidden";
        message.textContent = "Mixing cups...";
        shuffleCups(30, ()=>{
          mixed = true;
          message.textContent = "Guess under which cup the ball is hiding!";
          startCountdown();
        });
      }, 1000);

      cups.forEach((cup, idx)=>{
        cup.onclick = function(){
          if (!mixed) return;
          cups.forEach(cup2 => cup2.classList.remove('lifted'));
          cup.classList.add('lifted');
          ball.style.visibility = "visible";
          positionBall(idx);
          if (liftTimeout) clearTimeout(liftTimeout);
          if(idx === ballIndex){
            message.textContent = "‚úÖ Correct! You found the ball!";
          } else {
            message.textContent = "‚ùå Wrong! Try again!";
          }
          if(countdown) clearInterval(countdown);
          liftTimeout = setTimeout(()=>{
            cup.classList.remove('lifted');
            ball.style.visibility = "hidden";
          }, 1800);
          mixed = false;
        }
      });
    };

    resetGame();
  </script>
</body>
</html>
